# 消防安全管理系统

消防安全管理系统是一个全面的平台，用于管理消防安全设备、追踪有效期、发送预警通知，并提供数据分析功能。

## 主要功能

- 微型消防站物资管理
- 消防器材管理
- 有效期预警
- 数据统计与分析
- 用户与权限管理
- 定时任务管理

## 定时任务管理

定时任务功能允许系统自动定期检查物资有效期并发送预警邮件，无需人工干预。

### 功能特点

- **灵活的执行频率**：支持每天、每周或每月执行
- **多级预警设置**：可选择已过期、30天内到期、60天内到期和90天内到期的物资
- **精确的收件人筛选**：可选择向所有负责人发送或仅向特定负责人发送
- **任务管理操作**：支持创建、编辑、启用/禁用、立即执行和删除任务

### 创建定时任务

1. 导航至"定时任务管理"页面
2. 点击"展开/收起"按钮展开添加任务表单
3. 填写任务名称
4. 选择执行频率（每天/每周/每月）
5. 设置执行时间
6. 根据频率类型，选择执行日期（周几或每月几号）
7. 选择预警级别（已过期、30天内、60天内、90天内）
8. 选择收件人设置（所有负责人或特定负责人）
9. 点击"添加任务"按钮保存

### 管理定时任务

- **编辑任务**：点击任务列表中的编辑按钮，修改任务参数
- **启用/禁用任务**：点击启用/禁用按钮切换任务状态
- **立即执行**：点击闪电图标立即执行任务，无需等待计划时间
- **删除任务**：点击删除按钮并确认删除

### 任务执行

当定时任务执行时，系统将：

1. 检查所有物资的有效期（微型站物资和消防器材）
2. 根据任务设置的预警级别筛选即将到期的物资
3. 根据收件人设置确定邮件接收者
4. 为每位接收者生成个性化邮件内容（仅包含其负责的物资）
5. 发送预警邮件并记录日志

### 邮件记录

所有发送的邮件都会在"邮件日志"页面中记录，包括：
- 发送时间
- 发送状态（成功/失败）
- 收件人信息
- 包含的物品数量
- 错误信息（如果发送失败）

## 系统要求

- Python 3.6+
- Flask框架
- SQLite数据库
- SMTP邮件服务器（用于发送预警邮件）

## 其他功能

// 其他系统功能的描述...
